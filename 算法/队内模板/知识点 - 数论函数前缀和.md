# çŸ¥è¯†ç‚¹ - æ•°è®ºå‡½æ•°å‰ç¼€å’Œ

## 1.çº¦æ•°ä¸ªæ•°

ä»¤$\tau(n)$ä¸ºnçš„çº¦æ•°ä¸ªæ•°ï¼Œæ±‚å…¶å‰ç¼€å’Œã€‚

### è§£æž

è‹¥nçš„è´¨å› æ•°åˆ†è§£ä¸º$n=p_1^{e_1} \cdot p_2^{e_2} \cdots p_k^{e_k}$ï¼Œåˆ™
$$
\tau(n) = (e_1 + 1) \cdot (e_2 + 1) \cdots (e_k + 1)
$$
ä¸è¿‡æ±‚è¿™ä¸ªå‰ç¼€å’Œæ—¶ä¸éœ€è¦æ­¤å…¬å¼ã€‚

æˆ‘ä»¬æœ‰
$$
\sum_{i=1}^{n}\tau(i)=\sum_{i=1}^{n}{\sum_{j=1}^{n}{[j|i]}}=\sum_{i=1}^{n}\lfloor\frac {n}{i}\rfloor
$$

å¯¹äºŽ
$$
y_1=\lfloor\frac{n}{x}\rfloor\\
y_2=\frac{n}{x}
$$
$n=12$æ—¶ä½œå›¾å¦‚ä¸‹ï¼š

![1568030452608](C:\Users\acm-14\AppData\Roaming\Typora\typora-user-images\1568030452608.png)

å½“$ iâ‰¤\sqrt n$æ—¶ï¼Œæ˜¾$\lfloor\frac{n}{i}\rfloor$ç„¶åªæœ‰$O(\sqrt n)$ä¸ªå–å€¼ï¼›å½“$ i>\sqrt n$æ—¶ï¼Œ$\lfloor\frac{n}{i}\rfloor<\sqrt n$æ˜¾ç„¶ä¹Ÿåªæœ‰$O(\sqrt n)$ä¸ªå–å€¼ï¼›
å¯¹äºŽå›ºå®š$\lfloor\frac{n}{i}\rfloor$,$i$çš„å–å€¼æ˜¯ä¸€æ®µè¿žç»­çš„åŒºé—´ï¼Œè¿™æ®µåŒºé—´æ˜¯$[\left\lfloor\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor+1}\right\rfloor+1,\left\lfloor\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor}\right\rfloor]$

å°†$\left\lfloor\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor}\right\rfloor$ä½œä¸ºåˆ†ç•Œçº¿ï¼Œæ‰€ä»¥æœ‰å¦‚ä¸‹ä»£ç ï¼š

```cpp
	int ans = 0;
	for (int l = 1, r; l <= n; l = r + 1){
		r = n / (n / l);
		ans += (r - l + 1)*(n / l);
	}
```

å³åŒºé—´çš„ä»£æ•°[è¯æ˜Ž](https://www.cnblogs.com/0xfffe/p/9648943.html)ï¼ŒðŸ‘ˆæˆ³è¿™é‡Œã€‚

å‡ ä½•ä¸Šå¯ä»¥ç†è§£ä¸ºå…ˆæ‰¾åˆ°å¯¹åº”çš„çº¢çº¿ï¼Œå³æ±‚å‡ºiç‚¹çš„å€¼$v=\lfloor\frac{n}{i}\rfloor$ï¼›ç„¶åŽæ±‚å‡ºçº¢çº¿çš„ç»ˆç‚¹,å³å³åŒºé—´$r=\lfloor\frac{n}{v}\rfloor$,ä»¥åŠå®ƒçš„èµ·ç‚¹$r=\lfloor\frac{n}{v+1}\rfloor$

## 2.çº¦æ•°å’Œ

ä»¤$\sigma(i)$ä¸ºnçš„çº¦æ•°å’Œï¼Œæ±‚å‰ç¼€å’Œã€‚

oeis A024916

[çº¦æ•°å’Œ](https://www.luogu.org/problem/P2424)

### è§£æž

ç±»ä¼¼ä¸Šé¢ï¼Œæœ‰ï¼š
$$
\sigma(n) = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot \frac{p_2^{e_2 + 1} - 1}{p_2 - 1} \cdots \frac{p_k^{e_k + 1} - 1}{p_k - 1}
$$
åŒä¸Šä¹Ÿæ²¡ç”¨ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æŽ¥å†™å‡ºï¼š
$$
\sum_{i=1}^{n}{\sigma(i)}=\sum_{i=1}^{n}{\sum_{j=1}^{n}{[j|i]\cdot j}}=\sum_{i=1}^{n}{i\cdot\sum_{j=1}^{n}{[i|j]}}=\sum_{i=1}^{n}{i\cdot\lfloor\frac{n}{i}\rfloor}=\sum_{i=1}^{n}{\frac{\lfloor\frac{n}{i}\rfloor\cdot (\lfloor\frac{n}{i}\rfloor+1)}{2}}
$$

æœ€åŽçš„ç­‰å¼
$$
\sum_{i=1}^{n}{i\cdot\lfloor\frac{n}{i}\rfloor}=\sum_{i=1}^{n}{\frac{\lfloor\frac{n}{i}\rfloor\cdot (\lfloor\frac{n}{i}\rfloor+1)}{2}}
$$
å¯ä»¥çœ‹æˆå¯¹æ¯ä¸ª$\lfloor\frac{n}{i}\rfloor$å›ºå®šçš„å—ï¼Œå°† $\lfloor\frac{n}{i}\rfloor$æå‡ºæ¥ï¼Œç„¶åŽå¯¹$i\in[\left\lfloor\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor+1}\right\rfloor+1,\left\lfloor\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor}\right\rfloor]$ç­‰å·®æ•°åˆ—æ±‚å’Œã€‚



## 3.æ¬§æ‹‰å‡½æ•°å’Œ

ä»¤$\Phi(n)=\sum_{i=1}^{n}{\varphi(i)}$ä¸ºæ¬§æ‹‰å‡½æ•°å‰ç¼€å’Œã€‚

### è§£æž

#### æŽ¨å¯¼1ï¼ˆå…·ä½“æ•°å­¦4.9èŠ‚çš„åšæ³•ï¼‰ï¼š

é¦–å…ˆå¯¹äºŽå®žæ•°xæœ‰ç»“è®ºï¼š
$$
\sum_{d\ge1}\Phi(\frac{x}{d})=\lfloor x\rfloor\cdot\lfloor x+1\rfloor/2\\
\mathrm{where\ }\Phi(x)=\Phi(\lfloor x\rfloor)
$$
å¾®æ‰°æ³•å°†ç¬¬1é¡¹æå‡ºæ¥æœ‰
$$
\Phi(x)=\lfloor x\rfloor\cdot\lfloor x+1\rfloor/2-\sum_{d\ge2}\Phi(\lfloor \frac{x}{d}\rfloor)
$$
å¾—åˆ°äº†ä¸€ä¸ªé€’æŽ¨å¼ï¼Œdlsæƒ³å‡ºäº†$O(n^\frac{3}{4})$çš„é€’æŽ¨æ–¹æ³•ï¼Œä¸‹ä¸€èŠ‚ä¼šè¯¦ç»†æè¿°ã€‚

å›žåˆ°ç¬¬ä¸€ä¸ªå¼å­ï¼šå¯ä»¥å°†å³è¾¹çœ‹æˆæ‰€æœ‰$0\le m\lt n\le x$çš„åˆ†æ•°$\frac{m}{n}$çš„ï¼ˆæœªçº¦åˆ†ï¼‰åˆ†æ•°çš„æ•°é‡ï¼Œè€Œå·¦è¾¹å¯ä»¥ç†è§£ä¸ºå½¢å¼ä¸º$\frac{m}{n}$ä¸”$\mathrm{gcd}(m,n)=d$çš„åˆ†æ•°çš„ä¸ªæ•°ä¸º$\Phi(\frac{x}{d})$.

ä¸è€ƒè™‘å¾®æ‰°æ³•ï¼Œç›´æŽ¥å¯¹ç¬¬ä¸€ä¸ªå¼å­ä½¿ç”¨èŽ«æ¯”ä¹Œæ–¯åæ¼”å˜å¼:
$$
g(x)=\sum_{d\ge1}f(x/d)\Leftrightarrow f(x)=\sum_{d\ge1}\mu(d)g(x/d)
$$
æ³¨æ„è¿™ä¸ªå˜å¼ä¸ŽåŽŸèŽ«æ¯”ä¹Œæ–¯å…¬å¼çš„åŒºåˆ«ï¼š
$$
g(n)=\sum_{d|n}f(d)\Leftrightarrow f(n)=\sum_{d|n}g(\frac{n}{d})\mu(d)
$$
è¯¥å˜å¼é€‚ç”¨äºŽæ‰€æœ‰
$$
\sum_{k,d\ge1}|f(x/kd)|\lt \infty
$$
è¿™é‡Œé¡ºä¾¿è¯æ˜Žä¸€ä¸‹ï¼š
$$
\sum_{d\ge1}\mu(d)g(x/d)=\sum_{d\ge1}\mu(d)\sum_{k\ge1}f(x/kd)\\\ \\
=\sum_{m\ge1}f(x/m)\sum_{k,d\ge1}\mu(d)[m=kd]\\\ \\
=\sum_{m\ge1}f(x/m)\sum_{d|m}\mu(d)=\sum_{m\ge1}f(x/m)[m=1]=f(x)
$$
$\sum_{d\ge1}\Phi(\frac{x}{d})$ç”¨åæ¼”ï¼Œå¾—åˆ°
$$
\Phi(x)=1/2\sum_{d\ge1}\mu(d)\lfloor x/d\rfloor\cdot\lfloor x/d+1\rfloor\\
$$
ç”±äºŽ$\lfloor x/d\rfloor$å‰æœ‰èŽ«æ¯”ä¹Œæ–¯å‡½æ•°çš„ç³»æ•°ï¼Œæ— æ³•ç”¨æ•´é™¤åˆ†å—ï¼Œå¤æ‚åº¦ä¾ç„¶ä¸ºO(n)ã€‚

ä¸è¿‡è¿™ä¸ªå¼å­å¯ä»¥ç”¨æ¥è®¡ç®—è¿‘ä¼¼å€¼:(å…·ä½“æ•°å­¦ch9ä¸­æœ‰è¯æ˜Ž)
$$
\Phi(x)=3/\pi^2x^2+O(xlogx)
$$



#### æŽ¨å¯¼2(æœæ•™ç­›)

##### æœæ•™ç­›ä»‹ç»

è®¾f(n)ä¸ºæ•°è®ºå‡½æ•°ï¼Œæ±‚
$$
S(n)=\sum_{i=1}^{n} f(n)
$$
dlsçš„æƒ³æ³•æ˜¯æ ¹æ®$f(n)$çš„æ€§è´¨ï¼Œæž„é€ ä¸€ä¸ª$S(n)$å…³äºŽ$S(\lfloor \frac{n}{i}\rfloor)$çš„é€’æŽ¨å¼ï¼Œæž„é€ æ–¹æ³•å¦‚ä¸‹ï¼š

è‹¥æ‰¾åˆ°äº†ä¸€ä¸ªåˆé€‚çš„$g(n)\  \mathrm{let}\ F=f*g $ å³
$$
F(n)=\sum_{d|n}f(\frac{n}{d})g(d)
$$
åˆ™æœ‰
$$
\sum F(n)=\sum_{i=1}^{n}\sum_{d|i}f(\frac{i}{d})g(d)=\sum_{d|i}\sum_{d=1}^nf(\frac{i}{d})g(d)\\
=\sum_{d=1}^ng(d)\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor} f(i)=\sum_{d=1}^{n}g(d)S(\lfloor\frac{n}{d}\rfloor)
$$
å³
$$
\sum_{i=1}^{n}\sum_{d|i}f(d)g(\frac{i}{d})=\sum_{i=1}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)\\
$$
æå‡º$g(1)S(n)$,ç§»é¡¹å¯ä»¥å¾—åˆ°é€’æŽ¨å¼
$$
g(1)S(n)=\sum_{i=1}^{n}F(i)-\sum_{i=2}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)
$$
æ³¨æ„åˆ°åŽåŠéƒ¨åˆ†çš„å¼å­ä¸­çš„$S(\lfloor\frac{n}{i}\rfloor)$å¯ä»¥ç”¨æ•´é™¤åˆ†å—$O(\sqrt n)$åœ°æ±‚å‡ºï¼ˆè§çŸ¥è¯†ç‚¹ - æ•´é™¤åˆ†å—ï¼‰ã€‚

è‹¥èƒ½å¤Ÿå¿«é€Ÿæ±‚ï¼šï¼ˆå…·ä½“æ¥è¯´ï¼Œå°äºŽ$O(\sqrt{n})$ï¼‰
$$
\sum_{i=1}^{n}(f*g)(i)ï¼Œ\sum_{i=1}^{n}g(i)
$$
é‚£ä¹ˆè®¡ç®—å•ä¸ªS(n)çš„æ—¶é—´å¤æ‚åº¦å°±å˜ä¸º
$$
T(n)=O(\sqrt{n})+\sum_{i=1}^{\sqrt{n}}{(T(i)+T(\frac{n}{i}))}\\\ \\
$$

å±•å¼€ä¸€é˜¶å°é‡ï¼Œç§¯åˆ†ï¼Œæœ‰
$$
T(n)=\sum_{i=1}^{\sqrt{n}}{O(\sqrt{i})+O(\sqrt{\frac{n}{i}})}=O(n^\frac{3}{4})
$$


#### æ±‚$\Phi$

åˆ©ç”¨æ€§è´¨
$$
\sum_{d|n}{\varphi(d)}=n\Leftrightarrow I*\varphi=id
$$

æ‰€ä»¥ä»¤$g(n)$ä¸ºå¸¸å‡½æ•°$I(n)=1$,å¸¦å…¥é€šå¼
$$
g(1)S(n)=\sum_{i=1}^{n}F(i)-\sum_{i=2}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)\\
$$
å¾—åˆ°ï¼š
$$
1\cdot \Phi(n)=\sum_{i=1}^{n}i-\sum_{i=2}^{n}1\cdot \Phi(\lfloor\frac{n}{i}\rfloor)\\
$$
å½“ç„¶ä¹Ÿå¯ä»¥ä»Ž$I*\varphi=id$ç›´æŽ¥ä»Žå¤´æŽ¨å¯¼ï¼Œæœ‰
$$
\therefore \varphi(n)=n-\sum_{d|n,d<n}{\varphi(d)}
$$

æŽ¨å¯¼å¾—ï¼š
$$
\phi(n)=\sum_{i=1}^{n}{\varphi(i)}=\sum_{i=1}^{n}{i-\sum_{d|i,d<i}{\varphi(d)}}=\frac{n\cdot(n+1)}{2}-\sum_{i=2}^{n}\sum_{d|i,d<i}{\varphi(d)}=\frac{n\cdot(n+1)}{2}-\sum_{\frac{i}{d}=2}^{n}\sum_{d=1}^{\left\lfloor\frac{n}{\frac{i}{d}}\right\rfloor}{\varphi(d)}\\=\frac{n\cdot(n+1)}{2}-\sum_{i=2}^{n}\sum_{d=1}^{\lfloor\frac{n}{i}\rfloor}{\varphi(d)}=\frac{n\cdot(n+1)}{2}-\sum_{i=2}^{n}{\phi(\lfloor\frac{n}{i}\rfloor)}
$$


è¿™é‡Œä¹Ÿå¯ä»¥ç†è§£ä¸ºåˆ†æž1 ä¸­çš„å¼å­ï¼š
$$
\frac{n\cdot(n+1)}{2}=\sum_{i=1}^{n}{i}=\sum_{i=1}^{n}\sum_{d}{[d|i]\cdot\varphi(d)}=\sum_{\frac{i}{d}=1}^{n}\sum_{d=1}^{\left\lfloor\frac{n}{\frac{i}{d}}\right\rfloor}{\varphi(d)}=\sum_{i=1}^{n}{\phi(\lfloor\frac{n}{i}\rfloor)}
$$

